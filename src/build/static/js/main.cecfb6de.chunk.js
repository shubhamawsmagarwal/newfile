(this.webpackJsonpsrc=this.webpackJsonpsrc||[]).push([[0],{1039:function(e,t,a){"use strict";a.r(t);var n=a(3),i=a.n(n),s=a(386),r=a.n(s),c=(a(398),a(399),a(215)),o=a(22),u=a.n(o),l=a(142),m=a(5),p=a(113),d=a(7),h=a(14),f=a(13),b=a(87),g=a(26),y=a(212),w=a.n(y),v=(a(654),[{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"address"},{name:"",type:"uint256"}],name:"users",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"images",outputs:[{name:"id",type:"uint256"},{name:"hash",type:"string"},{name:"price",type:"uint256"},{name:"owner",type:"address"},{name:"purchased",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"imageCount",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"address"}],name:"userImageCount",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,name:"id",type:"uint256"},{indexed:!1,name:"hash",type:"string"},{indexed:!1,name:"price",type:"uint256"},{indexed:!1,name:"owner",type:"address"},{indexed:!1,name:"purchased",type:"bool"}],name:"ImageUploaded",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"id",type:"uint256"},{indexed:!1,name:"hash",type:"string"},{indexed:!1,name:"price",type:"uint256"},{indexed:!1,name:"owner",type:"address"},{indexed:!1,name:"purchased",type:"bool"}],name:"ImagePurchased",type:"event"},{constant:!1,inputs:[{name:"_imageHash",type:"string"},{name:"_price",type:"uint256"}],name:"imageUpload",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"_id",type:"uint256"}],name:"purchaseImage",outputs:[],payable:!0,stateMutability:"payable",type:"function"}]),x=a(389),E=function(e){Object(h.a)(a,e);var t=Object(f.a)(a);function a(){return Object(m.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"text-center"},i.a.createElement("p",{className:"font-weight-bold text-secondary"},"Account:  ",this.props.account),i.a.createElement(b.b,{to:"/",className:"btn btn-lg btn-info"},"Home"),this.props.images.map((function(t,a){return i.a.createElement("div",{className:"m-4 text-center w-50 p-5",key:a},i.a.createElement("div",{className:"img-thumbnail"},i.a.createElement("img",{className:"w-50 p-3",src:"https://ipfs.infura.io/ipfs/".concat(t.hash),alt:"description"}),t.purchased?t.owner===e.props.account?i.a.createElement("p",{className:"font-weight-bold text-secondary"},"Bought"):i.a.createElement("p",{className:"font-weight-bold text-secondary"},"Sold"):i.a.createElement("p",{className:"font-weight-bold text-secondary"},window.web3.utils.fromWei(t.price.toString(),"Ether")," Eth")))})))}}]),a}(n.Component),k=function(e){Object(h.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).state={account:"",imageCount:0,userImageCount:0,userImages:[],images:[],loading:!0},n.imageUpload=n.imageUpload.bind(Object(p.a)(n)),n.purchaseImage=n.purchaseImage.bind(Object(p.a)(n)),n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadWeb3();case 2:return e.next=4,this.loadBlockchainData();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadWeb3",value:function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.ethereum){e.next=6;break}return window.web3=new w.a(window.ethereum),e.next=4,window.ethereum.enable();case 4:e.next=7;break;case 6:window.web3?window.web3=new w.a(window.web3.currentProvider):window.alert("Non-Ethereum browser detected. You should consider trying MetaMask!");case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"loadBlockchainData",value:function(){var e=Object(l.a)(u.a.mark((function e(){var t,a,n,i,s,r,o,l,m,p;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.web3,e.next=3,t.eth.getAccounts();case 3:return a=e.sent,n=a[0],this.setState({account:n}),i=new t.eth.Contract(v,"0x149d1eba3b71f073dc04d8e8d0e15182894d7514"),this.setState({file:i}),e.next=10,i.methods.imageCount().call();case 10:s=e.sent,this.setState({imageCount:s}),r=1;case 13:if(!(r<=s)){e.next=21;break}return e.next=16,i.methods.images(r).call();case 16:o=e.sent,this.setState({images:[].concat(Object(c.a)(this.state.images),[o])});case 18:r++,e.next=13;break;case 21:return e.next=23,i.methods.userImageCount(n).call();case 23:l=e.sent,this.setState({userImageCount:l}),r=0;case 26:if(!(r<l)){e.next=37;break}return e.next=29,i.methods.users(n,r).call();case 29:return m=e.sent,e.next=32,i.methods.images(m).call();case 32:p=e.sent,this.setState({userImages:[].concat(Object(c.a)(this.state.userImages),[p])});case 34:r++,e.next=26;break;case 37:this.setState({loading:!1});case 38:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),Object(d.a)(a,[{key:"imageUpload",value:function(e,t){this.setState({loading:!0}),this.state.file.methods.imageUpload(e,t).send({from:this.state.account}).then((function(e){window.location.reload(!1)}))}},{key:"purchaseImage",value:function(e,t){this.setState({loading:!0}),this.state.file.methods.purchaseImage(e).send({from:this.state.account,value:t}).then((function(e){window.location.reload(!1)}))}},{key:"render",value:function(){var e=this;return this.state.loading?i.a.createElement("div",{className:"text-center"},"Loading..."):i.a.createElement(b.a,null,i.a.createElement("div",null,i.a.createElement(g.a,{exact:!0,path:"/",render:function(t){return i.a.createElement(x.a,Object.assign({},t,{images:e.state.images,imageUpload:e.imageUpload,purchaseImage:e.purchaseImage,account:e.state.account}))}}),i.a.createElement(g.a,{exact:!0,path:"/user",render:function(t){return i.a.createElement(E,Object.assign({},t,{account:e.state.account,images:e.state.userImages}))}})))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(k,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},182:function(e,t){},389:function(e,t,a){"use strict";(function(e){var n=a(5),i=a(7),s=a(14),r=a(13),c=a(3),o=a.n(c),u=a(87),l=a(655)({host:"ipfs.infura.io",port:5001,protocol:"https"}),m=function(t){Object(s.a)(c,t);var a=Object(r.a)(c);function c(t){var i;return Object(n.a)(this,c),(i=a.call(this,t)).captureFile=function(t){t.preventDefault();var a=t.target.files[0],n=new window.FileReader;n.readAsArrayBuffer(a),n.onloadend=function(){i.setState({buffer:e(n.result)})}},i.onSubmit=function(e){e.preventDefault();var t=parseFloat(i.imagePrice.value);if(t<0)alert("can't be negative");else{var a=window.web3.utils.toWei(t.toString(),"Ether");i.setState({loading:!0}),l.add(i.state.buffer,(function(e,t){e?console.error(e):i.props.imageUpload(t[0].hash,a)}))}},i.state={buffer:null,loading:!1},i}return Object(i.a)(c,[{key:"render",value:function(){var e=this;return this.state.loading?o.a.createElement("div",{className:"text-center"},"Loading..."):o.a.createElement("div",null,o.a.createElement("div",{className:"text-center"},o.a.createElement("p",{className:"font-weight-bold text-secondary"},"Account:  ",this.props.account),o.a.createElement(u.b,{to:"/user",className:"btn btn-lg btn-info"},"Profile"),o.a.createElement("p",null,"\xa0"),o.a.createElement("h3",null,"Add Image"),o.a.createElement("form",{onSubmit:this.onSubmit},o.a.createElement("div",{className:"form-group"},o.a.createElement("input",{type:"text",ref:function(t){e.imagePrice=t},placeholder:"Image Price",required:!0})),o.a.createElement("input",{type:"file",onChange:this.captureFile}),o.a.createElement("button",{type:"submit",className:"btn btn-success"},"Add Image")),o.a.createElement("p",null,"\xa0"),o.a.createElement("h2",null,"Buy Image"),this.props.images.map((function(t,a){return t.purchased?null:o.a.createElement("div",{className:"m-3 text-center w-50 p-5",key:a},o.a.createElement("div",{className:"img-thumbnail"},o.a.createElement("img",{className:"w-50 p-3",src:"https://ipfs.infura.io/ipfs/".concat(t.hash),alt:"description"}),o.a.createElement("p",{className:"font-weight-bold text-secondary"},window.web3.utils.fromWei(t.price.toString(),"Ether")," Eth"),o.a.createElement("button",{name:t.id,value:t.price,className:"btn btn-info",onClick:function(t){e.props.purchaseImage(t.target.name,t.target.value)}},"Buy")))}))))}}]),c}(c.Component);t.a=m}).call(this,a(0).Buffer)},391:function(e,t,a){e.exports=a(1039)},399:function(e,t,a){},410:function(e,t){},417:function(e,t){},436:function(e,t){},438:function(e,t){},452:function(e,t){},454:function(e,t){},519:function(e,t){},521:function(e,t){},531:function(e,t){},533:function(e,t){},573:function(e,t){},654:function(e,t,a){},758:function(e,t){},814:function(e,t){},815:function(e,t){},830:function(e,t){}},[[391,1,2]]]);
//# sourceMappingURL=main.cecfb6de.chunk.js.map